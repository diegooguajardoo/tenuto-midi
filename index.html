<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>WebMidi.js Quick Start</title>
	<script src="https://cdn.jsdelivr.net/npm/webmidi@next/dist/iife/webmidi.iife.js"></script>
<script type="module">

	// Enable WebMidi.js and trigger the onEnabled() function when ready
	WebMidi
		.enable()
		.then(onEnabled)
		.catch(err => alert(err));

	// Function triggered when WebMidi.js is ready
	function onEnabled() {

		// Display available MIDI input devices
		if (WebMidi.inputs.length < 1) {
			document.body.innerHTML += "No device detected.";
		} else {
			WebMidi.inputs.forEach((device, index) => {
				document.body.innerHTML += `${index}: ${device.name} <br>`;
		});
		}

		// This part was added on step 3
		const mySynth = WebMidi.inputs[0];
		// const mySynth = WebMidi.getInputByName("TYPE NAME HERE!")

		mySynth.channels[1].addListener("noteon", e => {
			document.body.innerHTML += `<b>${e.note.name}</b> <br>`;
		});

		WebMidi
			.enable()
			.then(onEnabled)
			.catch(err => alert(err));

		function onEnabled() {

			// Inputs
			WebMidi.inputs.forEach(input => console.log(input.manufacturer, input.name));

			// Outputs
			WebMidi.outputs.forEach(output => console.log(output.manufacturer, output.name));

			const myInput = WebMidi.getInputByName("DigitalKBD");
			const mySynth = myInput.channels[1]; // <-- the MIDI channel (10)

			mySynth.addListener("noteon", e => {
				console.log(e.note.identifier, e.message.channel);
			})
		}		

	}

</script>
<script src="node_modules/webmidi/dist/iife/webmidi.iife.js"></script>
<script src="tenuto.js"></script>

</head>

<body>
	<h1>WebMidi.js Quick Start</h1>

</body>
</html>